from utils.cve_checker import get_cve_info

def check_vulnerabilities(scan_results):
    vulnerabilities = {}

    for host, ports in scan_results.items():
        vulnerabilities[host] = []
        for port, details in ports.items():
            service_name = details.get("name", "Unknown")
            version = details.get("version", "Unknown")
            
            cve_list = get_cve_info(service_name, version)
            if cve_list:
                for cve_id, desc in cve_list:
                    vulnerabilities[host].append(f"Port {port}: {cve_id} - {desc}")
    
    return vulnerabilities
